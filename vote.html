<!-- vote.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>너와 나의 산책 — 투표</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* --- 페이지 전용 보완 --- */
    .question { font-weight: 700; margin: 0 0 12px; }
    .choice-list { display: grid; gap: 10px; margin: 12px 0 18px; padding: 0; list-style: none; }
    .choice {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; border-radius: 12px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.10);
      cursor: pointer;
    }
    .choice input { accent-color: #6ea8fe; transform: scale(1.05); }

    .field { margin: 16px 0 8px; }
    .hint { color: var(--muted); font-size: 13px; margin: 4px 0 0; }

    .text {
      width: 100%; height: 44px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: #0f0f15; color: var(--text);
      padding: 0 12px; font-size: 16px; outline: none;
    }
    .text:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(110,168,254,0.25); }

    .actions { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 18px; }
    .full { width: 100%; }

    /* 결과 카드 공통 */
    .result {
      margin-top: 22px; padding: 16px 14px;
      border-radius: 14px; background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
    }
    .result h3 { margin: 0 0 8px; }
    .result p { margin: 6px 0; }

    /* 엔딩/에필로그 하단 액션 */
    .ending-actions, .epilogue-actions {
      margin-top: 12px; display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap;
    }

    /* 버튼 커스텀 - 마지막 산책(아이보리/골드) */
    #lastWalk {
      background: linear-gradient(135deg, #e6d18a 0%, #f8efc8 100%);
      border: none; color: #1a1a1c; font-weight: 600; transition: 0.25s;
    }
    #lastWalk:hover { filter: brightness(1.1); transform: translateY(-1.5px); }

    /* 버튼 커스텀 - 사건의 진상(아이보리/골드) */
    .truth-btn {
      background: linear-gradient(135deg, #e6d18a 0%, #f8efc8 100%);
      border: none; color: #1a1a1c; font-weight: 600; transition: 0.25s;
    }
    .truth-btn:hover { filter: brightness(1.05); transform: translateY(-1.5px); }

    /* 작가의 인사 토글 */
    details.author-note {
      margin-top: 12px; border-top: 1px dashed rgba(255,255,255,0.18); padding-top: 10px;
    }
    details.author-note summary {
      cursor: pointer; font-weight: 700; list-style: none; outline: none;
    }
    details.author-note[open] summary { opacity: 0.9; }
    .author-note-body { margin-top: 8px; color: var(--muted); line-height: 1.65; }

    /* 하단 내비 (이전 2개) */
    .bottom-nav { margin-top: 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    /* 작가의 인사 토글 화살표 표시 */
    details.author-note summary {
    cursor: pointer;
    list-style: none;
    padding-right: 18px;
    position: relative;
    }

    /* 닫혀 있을 때: ▼ */
    details.author-note summary::after {
    content: "▼";
    position: absolute;
    right: 0;
    top: 0;
    font-size: 13px;
    opacity: 0.7;
    transition: transform 0.25s, opacity 0.25s;
    }

    /* 펼쳐졌을 때: ▲ (회전) */
    details.author-note[open] summary::after {
    transform: rotate(-180deg);
    opacity: 0.9;
    }

    /* ====== 스페셜 버튼(마지막 산책/사건의 진상) 오버라이드 ====== */
    /* 기본 상태 */
    .nav-btn#lastWalk,
    .nav-btn.truth-btn {
    background: linear-gradient(135deg, #e6d18a 0%, #f8efc8 100%);
    color: #1a1a1c;
    border: none;
    font-weight: 600;
    transition: 0.25s;
    }

    /* hover / focus / active 전부 같은 톤 유지 */
    .nav-btn#lastWalk:hover,
    .nav-btn#lastWalk:focus,
    .nav-btn#lastWalk:active,
    .nav-btn.truth-btn:hover,
    .nav-btn.truth-btn:focus,
    .nav-btn.truth-btn:active {
    background: linear-gradient(135deg, #e6d18a 0%, #f8efc8 100%);
    color: #1a1a1c;
    filter: brightness(1.07);
    transform: translateY(-1.5px);
    border: none;
    }

    /* 접근성 포커스 링 (은은한 골드) */
    .nav-btn#lastWalk:focus-visible,
    .nav-btn.truth-btn:focus-visible {
    outline: none;
    box-shadow: 0 0 0 3px rgba(230, 209, 138, 0.35);
    }

    /* 모바일 탭 하이라이트 제거(선택) */
    .nav-btn#lastWalk, .nav-btn.truth-btn {
    -webkit-tap-highlight-color: transparent;
    }

  </style>
</head>
<body>
<main class="container">
  <div class="card">
    <p class="desc">BODDO SNACK MYSTERY</p>
    <br>

    <h1 class="title"><span class="em yellow">투표 및 엔딩 확인</span></h1>

    <div class="section">
      <p class="question">다음 중 <strong>헤일리를 살해한 범인</strong>을 선택해 주세요.</p>

      <!-- ✅ form 하나만 유지 -->
      <form id="vote-form" autocomplete="off">
        <ul class="choice-list">
          <li><label class="choice"><input type="radio" name="suspect" value="우즈" required /><span>우즈</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="띠띠" /><span>띠띠</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="제이슨" /><span>제이슨</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="톰" /><span>톰</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="마크" /><span>마크</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="레오" /><span>레오</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="루카스" /><span>루카스</span></label></li>
        </ul>

        <div class="field">
          <label for="motive" class="label">범인의 동기</label>
          <input id="motive" class="text" type="text" placeholder="예: 헤일리에게 복수" />
          <p class="hint">동기: “~~~~(하)기 위해서”에서 <strong>~~~~</strong> 부분만 적어주세요. (예: ‘헤일리에게 복수’)</p>
        </div>

        <div class="actions">
          <button type="submit" class="nav-btn full" id="submit">답안 제출</button>
        </div>
      </form>

      <!-- ✅ 엔딩 박스 (마지막 산책 & 사건의 진상 버튼 포함) -->
      <div id="result-ending" class="result" hidden>
        <h3 class="yellow">엔딩</h3>
        <p id="ending-text"></p>
        <p id="ending-note" class="hint"></p>

        <div class="ending-actions">
          <button class="nav-btn" id="lastWalk">마지막 산책</button>
          <button class="nav-btn truth-btn">사건의 진상</button>
        </div>
      </div>

      <!-- ✅ 에필로그 박스 (사건의 진상 버튼도 포함) -->
      <div id="result-epilogue" class="result" hidden>
        <h3 class="yellow">에필로그(마지막 산책)</h3>
        <p id="epilogue-text"></p>
        <hr class="divider" />
        <p id="epilogue-note" class="hint"></p>

        <div class="epilogue-actions">
          <button class="nav-btn truth-btn">사건의 진상</button>
        </div>
      </div>

      <!-- ✅ 사건의 진상 박스 (기본 숨김) -->
      <div id="result-truth" class="result" hidden>
        <h3 class="yellow">사건의 진상</h3>
        <p id="truth-text"></p>
        <p id="truth-note" class="hint"></p>

        <!-- 작가의 인사 토글 -->
        <details class="author-note">
          <summary>작가의 인사</summary>
          <div class="author-note-body" id="author-message">
            <p>안녕하세요, 보또입니다.</p>
            <p>저의 세 번째 작품 [너와 나의 산책]을 플레이해주셔서 감사합니다.</p>
            <p>최근 2~3인 머더 미스터리에 매력을 느끼며, 가까운 사람과 가볍지만 깊게 즐길 수 있는 이야기를 만들고 싶었습니다. 그래서 조금 특별한 관계인 ‘사람’과 ‘반려견’이 함께 사건을 풀어나가는 구성을 생각하게 되었고, 그 관계가 작품 속에서 자연스럽게 받아들여졌기를 바랍니다.</p>
            <p>작중 이름은 저희 사무실 식구들의 실제 이름과 별명에서 가져왔습니다. 【우즈】는 【헤일리】라는 친구가 가장 좋아하는 가수의 이름이고, 【띠띠】는 실제로 반려견 ‘앵두’를 키우는 친구의 별명입니다. 골든 리트리버와 잘 어울리는 이름이라 허락을 받고 작품에 사용했습니다.</p>
            <p>초기 설정부터 이 작품은 즐거웠습니다. 개는 예로부터 영혼을 볼 수 있다고 하죠. 그 말에서 출발해 ‘유령’이지만 자신이 죽은 줄 모르는 인물(【우즈】)과 함께하는 이야기를 구상했습니다. 그리고 이 관계가 더 설득력 있게 다가오도록, 【띠띠】는 노견으로 설정했습니다. 둘은 가장 소중한 사람의 죽음을 함께 파헤치다 【우즈】 역시 죽었다는 사실을 깨닫고, 【우즈】가 죽음을 받아들이고 【띠띠】와 이별하는 이야기를 만들어야겠다고 생각했습니다.</p>
            <p>엔딩 이후의 [마지막 산책] 장면은 특히 오랜 시간 고민했습니다. 홀로 남아 기억을 품고 살아가는 【띠띠】의 삶과, 가족들과 함께 무지개다리를 건너는 【띠띠】의 삶 중 어떤 선택이 더 행복할까를 반려견을 키우는 친구와 함께 이야기했고, 지금의 에필로그를 준비했습니다.</p>
            <p>하지만 만약 여러분 마음속에 다른 결말이 있다면, 그 결말 그대로 기억해주셔도 좋습니다. 저는 【헤일리】, 【우즈】, 【띠띠】 모두가 행복했으면 합니다. 여러분은 본 이야기 속에서 【우즈】였으며, 【띠띠】였기에 여러분이 행복할 것 같은 결말로 기억해 주세요.</p>
            <p>플레이해주신 모든 분들께 진심으로 감사드립니다. 더 좋은 작품으로 다시 찾아뵙겠습니다.</p>
            <p>마지막으로 작은 선물을 준비했습니다.<br> ▼ 각 캐릭터의 플레이 카드를 클릭하여 기념으로 간직해주세요.</p>
            <div class="card-gallery">
              <a href="woods.png" download>
                <img src="woods.png" alt="우즈 플레이 카드">
              </a>
              <a href="ttiti.png" download>
                <img src="ttiti.png" alt="띠띠 플레이 카드">
              </a>
            </div>
          </div>
        </details>
      </div>

      <div class="bottom-nav">
        <button class="nav-btn prev" id="prevWoods">이전(우즈 Story)</button>
        <button class="nav-btn prev" id="prevDdiddi">이전(띠띠 Story)</button>
      </div>
    </div>

    <hr class="custom-hr" />
    <section><p class="made">© Copyright 2025. 보또 All rights reserved.</p></section>
  </div>
</main>

<script type="module">
  import { guard, logout } from "./gate.js";
  guard();

  // 이전 페이지 이동
  document.querySelector('#prevWoods').onclick = () => (location.href = "woods.html");
  document.querySelector('#prevDdiddi').onclick = () => (location.href = "ttiti.html");

  // 엔딩 텍스트 템플릿
  const ENDINGS = {
    "우즈": "우리는 【헤일리】를 살해한 범인이 【우즈】라고 결론지었다.",
    "띠띠": "우리는 【헤일리】를 살해한 범인이 【띠띠】라고 결론지었다.",
    "제이슨": "우리는 【헤일리】를 살해한 범인이 【제이슨】이라고 결론지었다.",
    "톰": "우리는 【헤일리】를 살해한 범인이 【톰】이라고 결론지었다.",
    "마크": "우리는 【헤일리】를 살해한 범인이 【마크】라고 결론지었다.",
    "레오": "우리는 【헤일리】를 살해한 범인이 【레오】라고 결론지었다.",
    "루카스": "우리는 【헤일리】를 살해한 범인이 【루카스】라고 결론지었다.",
  };
    // 엔딩 텍스트 템플
    const ENDINGS2 = {
    "우즈": "그때, 【헤일리】가 우리 앞에 나타났다.\n“그게 무슨 말이야. 그럴 리가 없잖아. 대체 【우즈】가 나를 죽였다고 생각하는 이유가 뭐야? 둘이 뭘 숨기고 있는 거야? 분명 뭔가 오해하고 있는 거야.”\n【헤일리】의 목소리가 떨렸다.\n“나를 위해 범인을 찾는다고 했지? 나는… 너희가 이런 결론을 내린 게 내가 죽은 것보다 더 속상해.”\n그녀가 우리를 번갈아 바라보며 말했다.\n“둘 다 숨김없이 모든 걸 말해줘. 나도 내가 기억하는 걸 다시 말할게. 그는 분명히 【띠띠】의 상태를 걱정했고, 우리 집에 관심을 가졌던 인물이야. 자, 둘도 숨김없이 모든 걸 털어놔.”\n[지시] 여러분에게 추가로 10분의 대화 시간이 주어졌습니다. 이번이 정말 마지막 기회입니다. 【헤일리】를 살해한 범인을 찾아 다시 투표해주세요.\n만약 여기서 이야기를 마치겠다면 사건의 진상으로 넘어갑니다. [마지막 산책]은 【우즈】 엔딩에서는 제공하지 않습니다.",
    "띠띠": "그때, 【헤일리】가 우리 앞에 나타났다.\n“그게 무슨 말이야. 그럴 리가 없잖아. 대체 【띠띠】가 나를 죽였다고 생각하는 이유가 뭐야? 둘이 뭘 숨기고 있는 거야? 분명 뭔가 오해하고 있는 거야.”\n【헤일리】의 목소리가 떨렸다.\n“나를 위해 범인을 찾는다고 했지? 나는… 너희가 이런 결론을 내린 게 내가 죽은 것보다 더 속상해.”\n그녀가 우리를 번갈아 바라보며 말했다.\n“둘 다 숨김없이 모든 걸 말해줘. 나도 내가 기억하는 걸 다시 말할게. 그는 분명히 【띠띠】의 상태를 걱정했고, 우리 집에 관심을 가졌던 인물이야. 자, 둘도 숨김없이 모든 걸 털어놔.”\n[지시] 여러분에게 추가로 10분의 대화 시간이 주어졌습니다. 이번이 정말 마지막 기회입니다. 【헤일리】를 살해한 범인을 찾아 다시 투표해주세요.\n만약 여기서 이야기를 마치겠다면 사건의 진상으로 넘어갑니다. [마지막 산책]은 【띠띠】 엔딩에서는 제공하지 않습니다.",
    "제이슨": "“【띠띠】, 우리가 찾은 단서를 네가 【썬즈 씨】에게 건네는 거야. 네가 찾아서 가져다 준 것은 불법이라 보기 어려울 거야. 할 수 있지? 띠띠? 이제 정말 시간이 없어.“ 우리는 우리가 결정적 단서라고 생각했던 물건을 썬즈 씨의 사무실 앞에 가져다 놓았다. 그리고 띠띠는 목이 터지라 짖었다. 잠시 후 나온 썬즈 씨는 어리둥절 하더니, 이윽고 이게 헤일리 사건의 단서인거냐며 띠띠를 쓰다듬어 준 뒤, 곧장 사진을 찍고 인터넷 기사를 준비했다. 기사 내용은 헤일리를 짝사랑 했던 남자의 끔직한 범죄. 곧 기사를 올린 그녀의 사무실로 경찰서에서 전화가 걸려왔다. 썬즈 대체 이게 무슨 짓이냐. 이게 무슨 말도 안되는 일이야. 그날 제이슨 씨는 마크 씨와 사진을 거래하고 있었다는 알리바이가 확인되었다. 제이슨씨는 범인이 아니야. 당장 기사를 내리도록 해. 어디서 부터 잘 못된 걸까. 우리의 추리를 탓하고 있을 때, 우리 앞에 헤일리가 나타났다. 둘 다 수고했어. 그런데 이제 그만하자. 나는 이미 죽었고, 나는 우즈랑 띠띠랑 함께했던 삶이 충분히 행복했어. 그러니 미련은 없어. 우즈, 띠띠 우리 마지막 산책가지 않을래? 여기서의 미련은 다 잊고, 우리 즐겁게 산책가자. 그리고 이제 떠나는 거야. 나는 너희가 더는 슬퍼하고 괴로워하지 않았으면 좋겠어.",
    "톰": "여기에 톰 2 엔딩 내용을 넣어주세요.",
    "마크": "여기에 마크 2 엔딩 내용을 넣어주세요.",
    "레오": "여기에 레오 2 엔딩 내용을 넣어주세요.",
    "루카스": "여기에 루카스 2 엔딩 내용을 넣어주세요.",
  };


  // 노드 캐시
  const form = document.querySelector('#vote-form');

  const endingBox  = document.querySelector('#result-ending');
  const endingText = document.querySelector('#ending-text');
  const endingNote = document.querySelector('#ending-note');

  const epiBox  = document.querySelector('#result-epilogue');
  const epiText = document.querySelector('#epilogue-text');
  const epiNote = document.querySelector('#epilogue-note');

  const truthBox  = document.querySelector('#result-truth');
  const truthText = document.querySelector('#truth-text');
  const truthNote = document.querySelector('#truth-note');

  form.addEventListener('submit', (e) => {
  e.preventDefault();
  const data = new FormData(form);
  const suspect = data.get('suspect');
  const motive = (document.querySelector('#motive').value || '').trim();

  // ① 범인 이름 표시 : 엔딩 1
  const headerLine = ``;

  // ② 기존 엔딩
  const base = ENDINGS[suspect] || "";
  const baseLine = base;

  // ③ 동기 (사용자가 입력한 그대로, “하기 위해서” 자동 처리 없음)
  const motiveLine = motive ? `그가 ${motive}(하)기 위해서 범행을 계획했다고 판단했다.` : "";

  // ④ 두 번째 엔딩 : 엔딩 2
  const second = ENDINGS2[suspect] || "";
  const secondLine = second ? `${second}` : "";

  // 출력 구성
  endingText.textContent = [
    headerLine,
    baseLine,
    motiveLine,
    secondLine
  ].filter(Boolean).join("\n\n");

  endingNote.textContent = "에필로그(마지막 산책)가 준비되어 있습니다.\n바로 사건의 진상으로 넘어가셔도 좋습니다.";

  endingBox.hidden = false;
  epiBox.hidden = true;
  truthBox.hidden = true;

  endingBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
});

  // 마지막 산책 → 에필로그만 표시
  document.querySelector('#lastWalk')?.addEventListener('click', () => {
    const epilogue = [
      "밤공기는 차분했고, 발자국 소리는 짧게 이어졌다.",
      "우리는 아무 말도 하지 않았지만, 서로가 바라본 그림자는 같은 방향을 가리켰다.",
      "돌아갈 수 없는 대화의 끝에서, 누군가는 진실을 선택해야 했다."
    ].join(" ");

    epiText.textContent = epilogue;
    epiNote.textContent = "사건의 진상을 확인하고 싶은 분은 [사건의 진상]을 눌러주세요";

    epiBox.hidden = false;
    truthBox.hidden = true;

    epiBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });

  // 사건의 진상 버튼(엔딩/에필로그 둘 다) → 진상 박스 표시
  document.querySelectorAll('.truth-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      // 여기 내용은 실제 작품 로직에 맞게 교체 가능
      const reveal = [
        "※ 여기에는 ‘사건의 핵심 트릭/동선/도구/알리바이 붕괴’를 정리해 넣으세요.",
        "예시) 범행 시각의 공회전 소음 때문에 비명은 들리지 않았고,",
        "폴라로이드의 플래시 지연과 병원의 출입기록(자동문 센서)이 결정적 반증이 되었다."
      ].join(" ");

      truthText.textContent = reveal;
      truthNote.textContent = "다시 한 번 플레이 해주셔서 감사합니다.";

      truthBox.hidden = false;
      truthBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });
</script>
</body>
</html>
