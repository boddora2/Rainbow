<!-- vote.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>너와 나의 산책 — 투표</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .question { font-weight: 700; margin: 0 0 12px; }
    .choice-list { display: grid; gap: 10px; margin: 12px 0 18px; padding: 0; list-style: none; }
    .choice {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; border-radius: 12px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.10);
      cursor: pointer;
    }
    .choice input { accent-color: #6ea8fe; transform: scale(1.05); }

    .field { margin: 16px 0 8px; }
    .hint { color: var(--muted); font-size: 13px; margin: 4px 0 0; }

    .text {
      width: 100%; height: 44px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: #0f0f15; color: var(--text);
      padding: 0 12px; font-size: 16px; outline: none;
    }
    .text:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(110,168,254,0.25); }

    .actions { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 18px; }
    .full { width: 100%; }

    .result {
      margin-top: 22px; padding: 16px 14px;
      border-radius: 14px; background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
    }

    .ending-actions { margin-top: 12px; display: flex; justify-content: flex-end; }
    #lastWalk { background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.15); }

    .bottom-nav { margin-top: 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  </style>
</head>
<body>
<main class="container">
  <div class="card">
    <p class="desc">BODDO SNACK MYSTERY</p>
    <br>

    <h1 class="title"><span class="em yellow">투표 및 엔딩 확인</span></h1>

    <div class="section">
      <p class="question">다음 중 <strong>헤일리를 살해한 범인</strong>을 선택해 주세요.</p>

      <!-- ✅ form 하나만 유지 -->
      <form id="vote-form" autocomplete="off">
        <ul class="choice-list">
          <li><label class="choice"><input type="radio" name="suspect" value="우즈" required /><span>우즈</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="띠띠" /><span>띠띠</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="제이슨" /><span>제이슨</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="톰" /><span>톰</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="마크" /><span>마크</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="레오" /><span>레오</span></label></li>
          <li><label class="choice"><input type="radio" name="suspect" value="루카스" /><span>루카스</span></label></li>
        </ul>

        <div class="field">
          <label for="motive" class="label">범인의 동기</label>
          <input id="motive" class="text" type="text" placeholder="예: 헤일리에게 복수" />
          <p class="hint">동기: “~~~~하기 위해서”에서 <strong>~~~~</strong>부분을 적어주세요.</p>
        </div>

        <div class="actions">
          <button type="submit" class="nav-btn full" id="submit">답안 제출</button>
        </div>
      </form>

      <!-- ✅ 엔딩 박스 (마지막 산책 버튼 포함) -->
      <div id="result-ending" class="result" hidden>
        <h3 class="yellow">엔딩</h3>
        <p id="ending-text"></p>
        <p id="ending-note" class="hint"></p>

        <div class="ending-actions">
          <button class="nav-btn" id="lastWalk">마지막 산책</button>
        </div>
      </div>

      <!-- ✅ 에필로그 박스 -->
      <div id="result-epilogue" class="result" hidden>
        <h3 class="yellow">에필로그</h3>
        <p id="epilogue-text"></p>
        <hr class="divider" />
        <p id="epilogue-note" class="hint"></p>
      </div>

      <div class="bottom-nav">
        <button class="nav-btn prev" id="prevWoods">이전(우즈 Story)</button>
        <button class="nav-btn prev" id="prevDdiddi">이전(띠띠 Story)</button>
      </div>
    </div>

    <hr class="custom-hr" />
    <section><p class="made">© Copyright 2025. 보또 All rights reserved.</p></section>
  </div>
</main>

<script type="module">
  import { guard, logout } from "./gate.js";
  guard();

  document.querySelector('#prevWoods').onclick = () => location.href = "woods.html";
  document.querySelector('#prevDdiddi').onclick = () => location.href = "ttiti.html";

  const ENDINGS = {
    "우즈": "당신의 선택은 ‘우즈’. ~~.",
    "띠띠": "당신의 선택은 ‘띠띠’. ~~.",
    "제이슨": "당신의 선택은 ‘제이슨’. ~~",
    "톰": "당신의 선택은 ‘톰’. 가족을 ~~",
    "마크": "당신의 선택은 ‘마크’. ~~.",
    "레오": "당신의 선택은 ‘레오’. ~~",
    "루카스": "당신의 선택은 ‘루카스’. ~~."
  };

  const form = document.querySelector('#vote-form');
  const endingBox = document.querySelector('#result-ending');
  const endingText = document.querySelector('#ending-text');
  const endingNote = document.querySelector('#ending-note');

  const epiBox = document.querySelector('#result-epilogue');
  const epiText = document.querySelector('#epilogue-text');
  const epiNote = document.querySelector('#epilogue-note');

  form.addEventListener('submit', (e) => {
    e.preventDefault();
    const data = new FormData(form);
    const suspect = data.get('suspect');
    const motive = (document.querySelector('#motive').value || '').trim();

    const base = ENDINGS[suspect];
    const motiveLine = motive ? `\n\n동기: 「${motive}」하기 위해서.` : "";

    endingText.textContent = base + motiveLine;
    endingNote.textContent = "※ 이 엔딩은 연출용 예시입니다.";
    endingBox.hidden = false;
    epiBox.hidden = true;

    endingBox.scrollIntoView({ behavior: 'smooth' });
  });

  document.querySelector('#lastWalk').addEventListener('click', () => {
    epiText.textContent =
      "밤공기는 차분했고, 발자국 소리는 짧게 이어졌다. 우리는 아무 말도 하지 않았지만, 서로가 바라본 그림자는 같은 방향을 가리켰다.";
    epiNote.textContent = "후일담은 선택적으로 변경 가능합니다.";

    epiBox.hidden = false;
    epiBox.scrollIntoView({ behavior: 'smooth' });
  });
</script>
</body>
</html>
