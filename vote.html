<!-- vote.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>너와 나의 산책 — 투표</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* 페이지 전용 살짝 보완 */
    .question { font-weight: 700; margin: 0 0 12px; }
    .choice-list { display: grid; gap: 10px; margin: 12px 0 18px; padding: 0; list-style: none; }
    .choice {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; border-radius: 12px;
      background: rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.10);
      cursor: pointer;
    }
    .choice input { accent-color: #6ea8fe; transform: scale(1.05); }
    .field { margin: 16px 0 8px; }
    .hint { color: var(--muted); font-size: 13px; margin: 4px 0 0; }
    .text {
      width: 100%; height: 44px; border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      background: #0f0f15; color: var(--text);
      padding: 0 12px; font-size: 16px; outline: none;
    }
    .text:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(110,168,254,0.25); }

    .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 18px; }
    .full { grid-column: 1 / -1; }

    /* 결과 카드 */
    .result {
      margin-top: 22px; padding: 16px 14px;
      border-radius: 14px; background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.12);
    }
    .result h3 { margin: 0 0 8px; }
    .result p { margin: 6px 0; }

    /* 하단 내비 (이전 2개) */
    .bottom-nav { margin-top: 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  </style>
</head>
<body>
<main class="container">
  <div class="card">
    <p class="desc">BODDO SNACK MYSTERY</p>
    <br>

    <h1 class="title"><span class="em yellow">투표 및 엔딩 확인</span></h1>

    <div class="section">
      <p class="question">다음 중 <strong>헤일리를 살해한 범인</strong>을 선택해 주세요.</p>

      <form id="vote-form" autocomplete="off">
        <ul class="choice-list">
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="우즈" required />
              <span>우즈</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="띠띠" />
              <span>띠띠</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="제이슨" />
              <span>제이슨</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="톰" />
              <span>톰</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="마크" />
              <span>마크</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="레오" />
              <span>레오</span>
            </label>
          </li>
          <li>
            <label class="choice">
              <input type="radio" name="suspect" value="루카스" />
              <span>루카스</span>
            </label>
          </li>
        </ul>

        <div class="field">
          <label for="motive" class="label">범인이 헤일리를 살해한 동기는 무엇인가요?</label>
          <input id="motive" class="text" type="text" placeholder="예) 복수" />
          <p class="hint">동기: <code>복수</code> 같이 한 단어로 적어 주세요. (예: ‘복수’하기 위해서)</p>
        </div>

        <div class="actions">
          <button type="submit" class="nav-btn full" id="submit">답안 제출</button>
          <button type="button" class="nav-btn prev full" id="lastWalk">마지막 산책</button>
        </div>
      </form>

      <div id="result" class="result" hidden>
        <h3 class="yellow">엔딩</h3>
        <p id="ending-text"></p>
        <hr class="divider" />
        <p id="ending-note" class="hint"></p>
      </div>

      <div class="bottom-nav">
        <button class="nav-btn prev" id="prevWoods">이전(우즈 Story)</button>
        <button class="nav-btn prev" id="prevDdiddi">이전(띠띠 Story)</button>
      </div>
    </div>

    <hr class="custom-hr" />
    <section>
      <p class="made">© Copyright 2025. 보또 All rights reserved.</p>
    </section>
  </div>
</main>

<script type="module">
  import { guard, logout } from "./gate.js";
  guard();

  // 로그아웃
  document.querySelector('#logout')?.addEventListener('click', (e) => {
    e.preventDefault();
    logout();
  });

  // 이전 버튼들
  document.querySelector('#prevWoods')?.addEventListener('click', () => {
    location.href = "woods.html";
  });
  document.querySelector('#prevDdiddi')?.addEventListener('click', () => {
    location.href = "ddiddi.html";
  });

  // 엔딩 텍스트 템플릿 (필요하면 자유롭게 수정)
  const ENDINGS = {
    "우즈": "당신의 선택은 ‘우즈’. ~~.",
    "띠띠": "당신의 선택은 ‘띠띠’. ~~.",
    "제이슨": "당신의 선택은 ‘제이슨’. ~~",
    "톰": "당신의 선택은 ‘톰’. 가족을 ~~",
    "마크": "당신의 선택은 ‘마크’. ~~.",
    "레오": "당신의 선택은 ‘레오’. ~~",
    "루카스": "당신의 선택은 ‘루카스’. ~~."
  };

  const form = document.querySelector('#vote-form');
  const resultBox = document.querySelector('#result');
  const endingText = document.querySelector('#ending-text');
  const endingNote = document.querySelector('#ending-note');

  form?.addEventListener('submit', (e) => {
    e.preventDefault();
    const data = new FormData(form);
    const suspect = data.get('suspect');
    const motive = (document.querySelector('#motive')?.value || '').trim();

    if (!suspect) return;

    const base = ENDINGS[suspect] || "선택한 인물에 대한 엔딩이 준비되어 있습니다.";
    const motiveLine = motive ? `\n\n동기: 「${motive}」하기 위해서.` : "동기는 비공개로 처리되었습니다.";

    endingText.textContent = base + motiveLine;
    endingNote.textContent = "※ 결과 문구는 연출용 예시입니다. 실제 정답/엔딩 로직은 자유롭게 수정하세요.";
    resultBox.hidden = false;
    resultBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });

  // 마지막 산책
  document.querySelector('#lastWalk')?.addEventListener('click', () => {
    const epilogue = [
      "밤공기는 차분했고, 발자국 소리는 짧게 이어졌다.",
      "우리는 아무 말도 하지 않았지만, 서로가 바라본 그림자는 같은 방향을 가리켰다.",
      "마지막으로 남은 길. 돌아갈 수 없는 대화의 끝에서, 누군가는 진실을 선택해야 했다."
    ].join(" ");

    endingText.textContent = epilogue;
    endingNote.textContent = "‘마지막 산책’은 후일담/에필로그 연출 영역입니다. 필요하면 별도 페이지로 분리하세요.";
    resultBox.hidden = false;
    resultBox.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
</script>
</body>
</html>
